import{r as s,j as D,k as z}from"./index-b079be92.js";import{a as k,L as O,E as R,T as _}from"./axios-137262c9.js";function j(i,r,t){s.useEffect(()=>{if(!document)return;const o=document.querySelector('script[src="'.concat(i,'"]'));if(o!=null&&o.dataset.loaded){r==null||r();return}const n=o||document.createElement("script");o||(n.src=i);const e=()=>{n.dataset.loaded="1",r==null||r()};return n.addEventListener("load",e),t&&n.addEventListener("error",t),o||document.head.append(n),()=>{n.removeEventListener("load",e),t&&n.removeEventListener("error",t)}},[])}function M(i){let{chartVersion:r="current",chartPackages:t=["corechart","controls"],chartLanguage:o="en",mapsApiKey:n}=i;const[e,a]=s.useState(null),[c,u]=s.useState(!1);return j("https://www.gstatic.com/charts/loader.js",()=>{const l=window==null?void 0:window.google;l&&(l.charts.load(r,{packages:t,language:o,mapsApiKey:n}),l.charts.setOnLoadCallback(()=>{a(l)}))},()=>{u(!0)}),[e,c]}function U(i){let{onLoad:r,onError:t,...o}=i;const[n,e]=M(o);return s.useEffect(()=>{n&&r&&r(n)},[n]),s.useEffect(()=>{e&&t&&t()},[e]),null}const L={legend_toggle:!1,options:{},legendToggle:!1,getChartWrapper:()=>{},spreadSheetQueryParameters:{headers:1,gid:1},rootProps:{},chartWrapperParams:{}};let F=0;const q=()=>(F+=1,"reactgooglegraph-".concat(F)),N=["#3366CC","#DC3912","#FF9900","#109618","#990099","#3B3EAC","#0099C6","#DD4477","#66AA00","#B82E2E","#316395","#994499","#22AA99","#AAAA11","#6633CC","#E67300","#8B0707","#329262","#5574A6","#3B3EAC"],B=async function(i,r){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise((o,n)=>{const e="".concat(t.headers?"headers=".concat(t.headers):"headers=0"),a="".concat(t.query?"&tq=".concat(encodeURIComponent(t.query)):""),c="".concat(t.gid?"&gid=".concat(t.gid):""),u="".concat(t.sheet?"&sheet=".concat(t.sheet):""),l="".concat(t.access_token?"&access_token=".concat(t.access_token):""),h="".concat(e).concat(c).concat(u).concat(a).concat(l),p="".concat(r,"/gviz/tq?").concat(h);new i.visualization.Query(p).send(f=>{f.isError()?n("Error in query:  ".concat(f.getMessage()," ").concat(f.getDetailedMessage())):o(f.getDataTable())})})},{Provider:G,Consumer:H}=s.createContext(L),Q=i=>{let{children:r,value:t}=i;return s.createElement(G,{value:t},r)},S=i=>{let{render:r}=i;return s.createElement(H,null,t=>r(t))},K="#CCCCCC";class V extends s.Component{componentDidMount(){this.draw(this.props),window.addEventListener("resize",this.onResize),(this.props.legend_toggle||this.props.legendToggle)&&this.listenToLegendToggle()}componentWillUnmount(){const{google:r,googleChartWrapper:t}=this.props;window.removeEventListener("resize",this.onResize),r.visualization.events.removeAllListeners(t),t.getChartType()==="Timeline"&&t.getChart()&&t.getChart().clearChart()}componentDidUpdate(){this.draw(this.props)}render(){return null}constructor(...r){super(...r),this.state={hiddenColumns:[]},this.listenToLegendToggle=()=>{const{google:t,googleChartWrapper:o}=this.props;t.visualization.events.addListener(o,"select",()=>{const e=o.getChart().getSelection(),a=o.getDataTable();if(e.length===0||e[0].row||!a)return;const c=e[0].column,u=this.getColumnID(a,c);this.state.hiddenColumns.includes(u)?this.setState(l=>({...l,hiddenColumns:[...l.hiddenColumns.filter(h=>h!==u)]})):this.setState(l=>({...l,hiddenColumns:[...l.hiddenColumns,u]}))})},this.applyFormatters=(t,o)=>{const{google:n}=this.props;for(let e of o)switch(e.type){case"ArrowFormat":{new n.visualization.ArrowFormat(e.options).format(t,e.column);break}case"BarFormat":{new n.visualization.BarFormat(e.options).format(t,e.column);break}case"ColorFormat":{const a=new n.visualization.ColorFormat(e.options),{ranges:c}=e;for(let u of c)a.addRange(...u);a.format(t,e.column);break}case"DateFormat":{new n.visualization.DateFormat(e.options).format(t,e.column);break}case"NumberFormat":{new n.visualization.NumberFormat(e.options).format(t,e.column);break}case"PatternFormat":{new n.visualization.PatternFormat(e.options).format(t,e.column);break}}},this.getColumnID=(t,o)=>t.getColumnId(o)||t.getColumnLabel(o),this.draw=async t=>{let{data:o,diffdata:n,rows:e,columns:a,options:c,legend_toggle:u,legendToggle:l,chartType:h,formatters:p,spreadSheetUrl:C,spreadSheetQueryParameters:f}=t;const{google:m,googleChartWrapper:g}=this.props;let d,y=null;if(n){const v=m.visualization.arrayToDataTable(n.old),w=m.visualization.arrayToDataTable(n.new);y=m.visualization[h].prototype.computeDiff(v,w)}o!==null?Array.isArray(o)?d=m.visualization.arrayToDataTable(o):d=new m.visualization.DataTable(o):e&&a?d=m.visualization.arrayToDataTable([a,...e]):C?d=await B(m,C,f):d=m.visualization.arrayToDataTable([]);const b=d.getNumberOfColumns();for(let v=0;v<b;v+=1){const w=this.getColumnID(d,v);if(this.state.hiddenColumns.includes(w)){const A=d.getColumnLabel(v),P=d.getColumnId(v),x=d.getColumnType(v);d.removeColumn(v),d.addColumn({label:A,id:P,type:x})}}const E=g.getChart();g.getChartType()==="Timeline"&&E&&E.clearChart(),g.setChartType(h),g.setOptions(c||{}),g.setDataTable(d),g.draw(),this.props.googleChartDashboard!==null&&this.props.googleChartDashboard.draw(d),y&&(g.setDataTable(y),g.draw()),p&&(this.applyFormatters(d,p),g.setDataTable(d),g.draw()),(l===!0||u===!0)&&this.grayOutHiddenColumns({options:c})},this.grayOutHiddenColumns=t=>{let{options:o}=t;const{googleChartWrapper:n}=this.props,e=n.getDataTable();if(!e)return;const a=e.getNumberOfColumns();if(this.state.hiddenColumns.length>0===!1)return;const u=Array.from({length:a-1}).map((l,h)=>{const p=this.getColumnID(e,h+1);return this.state.hiddenColumns.includes(p)?K:o&&o.colors?o.colors[h]:N[h]});n.setOptions({...o,colors:u}),n.draw()},this.onResize=()=>{const{googleChartWrapper:t}=this.props;t.draw()}}}class $ extends s.Component{componentDidMount(){}componentWillUnmount(){}shouldComponentUpdate(){return!1}render(){const{google:r,googleChartWrapper:t,googleChartDashboard:o}=this.props;return s.createElement(S,{render:n=>s.createElement(V,Object.assign({},n,{google:r,googleChartWrapper:t,googleChartDashboard:o}))})}}class Y extends s.Component{shouldComponentUpdate(){return!1}listenToEvents(r){let{chartEvents:t,google:o,googleChartWrapper:n}=r;if(t){o.visualization.events.removeAllListeners(n);for(let a of t){var e=this;const{eventName:c,callback:u}=a;o.visualization.events.addListener(n,c,function(){for(var l=arguments.length,h=new Array(l),p=0;p<l;p++)h[p]=arguments[p];u({chartWrapper:n,props:e.props,google:o,eventArgs:h})})}}}componentDidMount(){var r;const{google:t,googleChartWrapper:o}=this.props;this.listenToEvents({chartEvents:((r=this.propsFromContext)===null||r===void 0?void 0:r.chartEvents)||null,google:t,googleChartWrapper:o})}render(){return this.props,s.createElement(S,{render:r=>(this.propsFromContext=r,null)})}constructor(r){super(r),this.propsFromContext=null}}let T=0;class J extends s.Component{componentDidMount(){const{options:r,google:t,chartType:o,chartWrapperParams:n,toolbarItems:e,getChartEditor:a,getChartWrapper:c}=this.props,u={chartType:o,options:r,containerId:this.getGraphID(),...n},l=new t.visualization.ChartWrapper(u);l.setOptions(r||{}),c&&c(l,t);const h=new t.visualization.Dashboard(this.dashboard_ref),p=this.addControls(l,h);e&&t.visualization.drawToolbar(this.toolbar_ref.current,e);let C=null;a&&(C=new t.visualization.ChartEditor,a({chartEditor:C,chartWrapper:l,google:t})),this.setState({googleChartEditor:C,googleChartControls:p,googleChartDashboard:h,googleChartWrapper:l,isReady:!0})}componentDidUpdate(){if(!this.state.googleChartWrapper||!this.state.googleChartDashboard||!this.state.googleChartControls)return;const{controls:r}=this.props;if(r)for(let t=0;t<r.length;t+=1){const{controlType:o,options:n,controlWrapperParams:e}=r[t];e&&"state"in e&&this.state.googleChartControls[t].control.setState(e.state),this.state.googleChartControls[t].control.setOptions(n),this.state.googleChartControls[t].control.setControlType(o)}}shouldComponentUpdate(r,t){return this.state.isReady!==t.isReady||r.controls!==this.props.controls}render(){const{width:r,height:t,options:o,style:n}=this.props,e={height:t||o&&o.height,width:r||o&&o.width,...n};return this.props.render?s.createElement("div",{ref:this.dashboard_ref,style:e},s.createElement("div",{ref:this.toolbar_ref,id:"toolbar"}),this.props.render({renderChart:this.renderChart,renderControl:this.renderControl,renderToolbar:this.renderToolBar})):s.createElement("div",{ref:this.dashboard_ref,style:e},this.renderControl(a=>{let{controlProp:c}=a;return c.controlPosition!=="bottom"}),this.renderChart(),this.renderControl(a=>{let{controlProp:c}=a;return c.controlPosition==="bottom"}),this.renderToolBar())}constructor(...r){var t;super(...r),t=this,this.state={googleChartWrapper:null,googleChartDashboard:null,googleChartControls:null,googleChartEditor:null,isReady:!1},this.graphID=null,this.dashboard_ref=s.createRef(),this.toolbar_ref=s.createRef(),this.getGraphID=()=>{const{graphID:o,graph_id:n}=this.props;let e;return!o&&!n?this.graphID?e=this.graphID:e=q():o&&!n?e=o:n&&!o?e=n:e=o,this.graphID=e,this.graphID},this.getControlID=(o,n)=>{T+=1;let e;return typeof o>"u"?e="googlechart-control-".concat(n,"-").concat(T):e=o,e},this.addControls=(o,n)=>{const{google:e,controls:a}=this.props,c=a?a.map((l,h)=>{const{controlID:p,controlType:C,options:f,controlWrapperParams:m}=l,g=this.getControlID(p,h);return{controlProp:l,control:new e.visualization.ControlWrapper({containerId:g,controlType:C,options:f,...m})}}):null;if(!c)return null;n.bind(c.map(l=>{let{control:h}=l;return h}),o);for(let l of c){const{control:h,controlProp:p}=l,{controlEvents:C=[]}=p;for(let f of C){var u=this;const{callback:m,eventName:g}=f;e.visualization.events.removeListener(h,g,m),e.visualization.events.addListener(h,g,function(){for(var d=arguments.length,y=new Array(d),b=0;b<d;b++)y[b]=arguments[b];m({chartWrapper:o,controlWrapper:h,props:u.props,google:e,eventArgs:y})})}}return c},this.renderChart=()=>{const{width:o,height:n,options:e,style:a,className:c,rootProps:u,google:l}=this.props,h={height:n||e&&e.height,width:o||e&&e.width,...a};return s.createElement("div",Object.assign({id:this.getGraphID(),style:h,className:c},u),this.state.isReady&&this.state.googleChartWrapper!==null?s.createElement(s.Fragment,null,s.createElement($,{googleChartWrapper:this.state.googleChartWrapper,google:l,googleChartDashboard:this.state.googleChartDashboard}),s.createElement(Y,{googleChartWrapper:this.state.googleChartWrapper,google:l})):null)},this.renderControl=function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:n=>!0;return t.state.isReady&&t.state.googleChartControls!==null?s.createElement(s.Fragment,null,t.state.googleChartControls.filter(n=>{let{controlProp:e,control:a}=n;return o({control:a,controlProp:e})}).map(n=>{let{control:e,controlProp:a}=n;return s.createElement("div",{key:e.getContainerId(),id:e.getContainerId()})})):null},this.renderToolBar=()=>this.props.toolbarItems?s.createElement("div",{ref:this.toolbar_ref}):null}}class W extends s.Component{render(){const{chartLanguage:r,chartPackages:t,chartVersion:o,mapsApiKey:n,loader:e,errorElement:a}=this.props;return s.createElement(Q,{value:this.props},this.state.loadingStatus==="ready"&&this.state.google!==null?s.createElement(J,Object.assign({},this.props,{google:this.state.google})):this.state.loadingStatus==="errored"&&a?a:e,s.createElement(U,{chartLanguage:r,chartPackages:t,chartVersion:o,mapsApiKey:n,onLoad:this.onLoad,onError:this.onError}))}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}isFullyLoaded(r){const{controls:t,toolbarItems:o,getChartEditor:n}=this.props;return r&&r.visualization&&r.visualization.ChartWrapper&&r.visualization.Dashboard&&(!t||r.visualization.ChartWrapper)&&(!n||r.visualization.ChartEditor)&&(!o||r.visualization.drawToolbar)}constructor(...r){super(...r),this._isMounted=!1,this.state={loadingStatus:"loading",google:null},this.onLoad=t=>{if(this.props.onLoad&&this.props.onLoad(t),this.isFullyLoaded(t))this.onSuccess(t);else{const o=setInterval(()=>{const n=window.google;this._isMounted?n&&this.isFullyLoaded(n)&&(clearInterval(o),this.onSuccess(n)):clearInterval(o)},1e3)}},this.onSuccess=t=>{this.setState({loadingStatus:"ready",google:t})},this.onError=()=>{this.setState({loadingStatus:"errored"})}}}W.defaultProps=L;var I;(function(i){i.annotation="annotation",i.annotationText="annotationText",i.certainty="certainty",i.emphasis="emphasis",i.interval="interval",i.scope="scope",i.style="style",i.tooltip="tooltip",i.domain="domain"})(I||(I={}));function X(){return"https://swapi.dev/api/films/.json"}const Z=i=>i.results.map(t=>({title:t.title,charactersCount:t.characters.length}));async function tt(){const r=await(await k.get(X())).data;return Z(r)}function et(){const[i,r]=s.useState([]),[t,o]=s.useState(!0),[n,e]=s.useState(null);async function a(){o(!0);try{const c=await tt();r(c)}catch(c){e(c)}finally{o(!1)}}return s.useEffect(()=>{a()},[]),{films:i,fetchData:a,isLoading:t,error:n}}function ot(i){let r=i;const t=["red","blue","yellow","green","orange","pink"];return r>t.length-1&&(r=r-t.length),r<0&&(r=0),t[r]}const rt="Characters for each film";function nt(){const{films:i,isLoading:r,error:t}=et(),o=i.map((c,u)=>{const l=ot(u);return[c.title,c.charactersCount,`color: ${l}`]}),n={legend:"none"},e=[{eventName:"select",callback:()=>{}}],a=[["Film","Characters",{role:"style"}],...o];return r?D.jsx(z,{block:!0,children:O}):t?D.jsxs(z,{block:!0,children:[R," ",t==null?void 0:t.message]}):D.jsxs(D.Fragment,{children:[D.jsx(_,{children:rt}),D.jsx(W,{chartType:"ColumnChart",data:a,options:n,height:"400px",chartEvents:e,legendToggle:!0})]})}function it(){return D.jsx(nt,{})}export{it as default};
